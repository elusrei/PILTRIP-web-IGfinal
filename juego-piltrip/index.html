<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego PILTRIP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap" rel="stylesheet">
    <style>
        #game-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }
        
        #game-canvas {
            display: block;
            width: 100%;
            height: auto;
            background: linear-gradient(to bottom, #0f172a, #1a2b5f);
        }
        
        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .game-panel {
            background: rgba(26, 43, 95, 0.85);
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: center;
            max-width: 80%;
        }
        
        #propulsion-container {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }
        
        .propulsion-indicator {
            width: 30px;
            height: 10px;
            background-color: #4a6bdb;
            border-radius: 5px;
        }
        
        .propulsion-indicator.empty {
            background-color: rgba(74, 107, 219, 0.3);
        }
        
        .control-info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(26, 43, 95, 0.7);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="bg-custom-dark text-light py-3">
        <nav class="container navbar navbar-expand-lg navbar-dark">
            <a class="navbar-brand" href="../index.html">
                <img src="../src/logo-piltrip-3.png" alt="logo de PILTRIP" height="50">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../narrativas-piltrip/index.html">Narrativa</a></li>
                    <li class="nav-item"><a class="nav-link" href="../universo-piltrip/index.html">Universo</a></li>
                    <li class="nav-item"><a class="nav-link" href="../merchandising-piltrip/index.html">Tiendas con Merch</a></li>
                    <li class="nav-item"><a class="nav-link" href="../parques-y-salas/index.html">Parque y Sala de Juegos</a></li>
                    <li class="nav-item"><a class="nav-link" href="../consumibles-piltrip/index.html">Consumibles</a></li>
                    <li class="nav-item">
                        <a class="btn nav-link active text-white border rounded px-4 py-2 bg-custom-dark btn-primary:hover btn-dark:hover shadow-lg" href="index.html">
                            Juego Piltrip
                        </a>
                    </li>
                </ul>
                <ul class="navbar-nav d-flex flex-column ms-auto">
                    <li class="nav-item mx-2">
                        <a class="nav-link" href="../contacto.html">
                            <i class="fas fa-envelope"></i> Contacto
                        </a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link" href="../sobre-desarrollador.html">
                            <i class="fas fa-user"></i> Desarrollador
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="container my-5">
        <h1 class="text-center mb-5">JUEGO <span>PILTRIP</span></h1>
        
        <div class="menu-section mb-5">
            <h2 class="text-center fst-italic mb-4">Navegante Espacial</h2>
            <p class="lead text-center">
                Pilota tu nave a través del espacio digital del metaverso PILTRIP, esquivando satélites y asteroides
                en esta emocionante aventura espacial. ¡Consigue la mayor puntuación posible!
            </p>
        </div>

        <div class="row justify-content-center mb-5">
            <div class="col-md-10">
                <div class="menu-section p-0 overflow-hidden">
                    <div id="game-container">
                        <!-- Pantalla de inicio -->
                        <div id="pantalla-inicio" class="game-overlay">
                            <div class="game-panel">
                                <h2 class="fs-3 fw-bold mb-3">PILTRIP: Navegante Espacial</h2>
                                <p class="mb-4">Esquiva los satélites y sobrevive el mayor tiempo posible.</p>
                                <button id="btn-iniciar" class="btn btn-primary">Iniciar Juego</button>
                                <button id="btn-fullscreen" class="btn btn-secondary ms-2">
                                    <i class="fas fa-expand"></i> Pantalla Completa
                                </button>
                            </div>
                        </div>

                        <!-- Pantalla de game over (oculta inicialmente) -->
                        <div id="pantalla-gameover" class="game-overlay" style="display: none;">
                            <div class="game-panel">
                                <h2 class="fs-3 fw-bold mb-2">¡Juego Terminado!</h2>
                                <p class="fs-5 mb-2">Puntuación: <span id="puntuacion-final">0</span></p>
                                <p class="fs-6 mb-4">Récord: <span id="record">0</span></p>
                                <button id="btn-reiniciar" class="btn btn-primary">Jugar de Nuevo</button>
                                <button id="btn-fullscreen-gameover" class="btn btn-secondary ms-2">
                                    <i class="fas fa-expand"></i> Pantalla Completa
                                </button>
                            </div>
                        </div>

                        <!-- Canvas del juego -->
                        <canvas id="game-canvas" width="800" height="600"></canvas>

                        <!-- Marcador de puntuación (oculto inicialmente) -->
                        <div id="marcador" class="position-absolute top-0 start-0 m-3 bg-custom-dark bg-opacity-75 px-3 py-2 rounded" style="display: none;">
                            <p class="fs-5 fw-bold mb-0">Puntuación: <span id="puntuacion-actual">0</span></p>
                            <p class="fs-6 mb-0">Nivel: <span id="nivel-actual">1</span></p>
                        </div>

                        <!-- Indicadores de propulsión (oculto inicialmente) -->
                        <div id="propulsion-container" style="display: none;">
                            <div class="propulsion-indicator" id="propulsion-1"></div>
                            <div class="propulsion-indicator" id="propulsion-2"></div>
                            <div class="propulsion-indicator" id="propulsion-3"></div>
                        </div>

                        <!-- Información de controles (oculto inicialmente) -->
                        <div class="control-info" id="control-info" style="display: none;">
                            <div><i class="fas fa-arrows-alt"></i> Mover nave</div>
                            <div><i class="fas fa-rocket"></i> SHIFT: Propulsión</div>
                            <div><i class="fas fa-stop-circle"></i> ESPACIO: Frenar</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-6 mb-4">
                <div class="menu-section h-100">
                    <h2 class="text-center mb-4">Controles</h2>
                    <div class="d-flex justify-content-center mb-4">
                        <div class="d-grid" style="grid-template-columns: repeat(3, 1fr); gap: 10px;">
                            <div></div>
                            <button class="btn btn-primary p-3 d-flex justify-content-center align-items-center">
                                <i class="fas fa-arrow-up"></i>
                            </button>
                            <div></div>
                            <button class="btn btn-primary p-3 d-flex justify-content-center align-items-center">
                                <i class="fas fa-arrow-left"></i>
                            </button>
                            <button class="btn btn-primary p-3 d-flex justify-content-center align-items-center">
                                <i class="fas fa-arrow-down"></i>
                            </button>
                            <button class="btn btn-primary p-3 d-flex justify-content-center align-items-center">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6 text-center">
                            <button class="btn btn-success p-3 w-100">
                                <i class="fas fa-rocket me-2"></i>SHIFT
                            </button>
                            <p class="mt-2">Propulsión (3 usos)</p>
                        </div>
                        <div class="col-md-6 text-center">
                            <button class="btn btn-danger p-3 w-100">
                                <i class="fas fa-stop-circle me-2"></i>ESPACIO
                            </button>
                            <p class="mt-2">Frenar en seco</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="menu-section h-100">
                    <h2 class="text-center mb-4">Objetivos</h2>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item" style="background: transparent; color: white;">
                            <i class="fas fa-rocket me-2"></i>
                            Pilota tu nave a través del espacio digital
                        </li>
                        <li class="list-group-item" style="background: transparent; color: white;">
                            <i class="fas fa-satellite me-2"></i>
                            Esquiva los satélites y asteroides que vienen de todas direcciones
                        </li>
                        <li class="list-group-item" style="background: transparent; color: white;">
                            <i class="fas fa-trophy me-2"></i>
                            Consigue la mayor puntuación posible
                        </li>
                        <li class="list-group-item" style="background: transparent; color: white;">
                            <i class="fas fa-level-up-alt me-2"></i>
                            Avanza de nivel para aumentar la dificultad
                        </li>
                        <li class="list-group-item" style="background: transparent; color: white;">
                            <i class="fas fa-rocket me-2"></i>
                            Usa la propulsión para escapar de situaciones peligrosas
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-custom-dark text-light py-4">
        <div class="container text-center">
            <div class="mb-3">
                <a href="https://www.tiktok.com/@piltrip.alternatives" target="_blank" class="text-light me-3">
                    <i class="fab fa-tiktok"></i>
                </a>
                <a href="https://x.com/piltrip" target="_blank" class="text-light me-3">
                    <i class="fab fa-x-twitter"></i>
                </a>
                <a href="https://www.youtube.com/@Piltrip" target="_blank" class="text-light me-3">
                    <i class="fab fa-youtube"></i>
                </a>
                <a href="https://www.instagram.com/piltrip/" target="_blank" class="text-light">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
            <a href="../index.html">
                <img src="../src/logo-piltrip-3.png" alt="Logo de PILTRIP" height="40">
            </a>
            
            <div class="my-3">
                <a href="../contacto.html" class="text-light ms-3">Contacto</a>
                <a href="../sobre-desarrollador.html" class="text-light ms-3">Sobre el Desarrollador</a>
            </div>
            <p class="mb-0">&copy; 2025 Piltrip. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Juego de esquivar satélites
        document.addEventListener('DOMContentLoaded', function() {
            // Elementos del DOM
            const canvas = document.getElementById('game-canvas');
            const ctx = canvas.getContext('2d');
            const gameContainer = document.getElementById('game-container');
            const btnIniciar = document.getElementById('btn-iniciar');
            const btnReiniciar = document.getElementById('btn-reiniciar');
            const btnFullscreen = document.getElementById('btn-fullscreen');
            const btnFullscreenGameover = document.getElementById('btn-fullscreen-gameover');
            const pantallaInicio = document.getElementById('pantalla-inicio');
            const pantallaGameover = document.getElementById('pantalla-gameover');
            const marcador = document.getElementById('marcador');
            const puntuacionActual = document.getElementById('puntuacion-actual');
            const puntuacionFinal = document.getElementById('puntuacion-final');
            const nivelActual = document.getElementById('nivel-actual');
            const recordElement = document.getElementById('record');
            const propulsionContainer = document.getElementById('propulsion-container');
            const propulsion1 = document.getElementById('propulsion-1');
            const propulsion2 = document.getElementById('propulsion-2');
            const propulsion3 = document.getElementById('propulsion-3');
            const controlInfo = document.getElementById('control-info');
            
            // Variables del juego
            let juegoActivo = false;
            let puntuacion = 0;
            let nivel = 1;
            let record = localStorage.getItem('piltrip_record') || 0;
            recordElement.textContent = record;
            let ultimoTiempo = 0;
            let propulsionesDisponibles = 3;
            let tiempoUltimaPropulsion = 0;
            let tiempoRecargaPropulsion = 5000; // 5 segundos para recargar una propulsión
            
            // Imágenes
            const naveImg = new Image();
            naveImg.src = 'nave.png'; // Esta imagen la cargará el usuario
            
            const asteroideImg = new Image();
            asteroideImg.src = 'asteroide.png'; // Esta imagen la cargará el usuario
            
            // Objeto nave
            const nave = {
                x: canvas.width / 2 - 25,
                y: canvas.height - 100,
                ancho: 50,
                alto: 50,
                velocidadBase: 5,
                velocidad: 5,
                velocidadX: 0,
                velocidadY: 0,
                movIzquierda: false,
                movDerecha: false,
                movArriba: false,
                movAbajo: false,
                propulsion: false,
                frenando: false
            };
            
            // Array de asteroides
            let asteroides = [];
            
            // Controles de teclado
            document.addEventListener('keydown', function(e) {
                if (!juegoActivo) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                        nave.movIzquierda = true;
                        break;
                    case 'ArrowRight':
                        nave.movDerecha = true;
                        break;
                    case 'ArrowUp':
                        nave.movArriba = true;
                        break;
                    case 'ArrowDown':
                        nave.movAbajo = true;
                        break;
                    case 'Shift':
                        // Activar propulsión si hay disponibles
                        if (propulsionesDisponibles > 0 && !nave.propulsion) {
                            nave.propulsion = true;
                            propulsionesDisponibles--;
                            actualizarIndicadoresPropulsion();
                            tiempoUltimaPropulsion = Date.now();
                        }
                        break;
                    case ' ': // Espacio
                        nave.frenando = true;
                        nave.velocidadX = 0;
                        nave.velocidadY = 0;
                        break;
                }
            });
            
            document.addEventListener('keyup', function(e) {
                switch(e.key) {
                    case 'ArrowLeft':
                        nave.movIzquierda = false;
                        break;
                    case 'ArrowRight':
                        nave.movDerecha = false;
                        break;
                    case 'ArrowUp':
                        nave.movArriba = false;
                        break;
                    case 'ArrowDown':
                        nave.movAbajo = false;
                        break;
                    case 'Shift':
                        nave.propulsion = false;
                        nave.velocidad = nave.velocidadBase;
                        break;
                    case ' ': // Espacio
                        nave.frenando = false;
                        break;
                }
            });
            
            // Función para actualizar los indicadores de propulsión
            function actualizarIndicadoresPropulsion() {
                propulsion1.className = propulsionesDisponibles >= 1 ? 'propulsion-indicator' : 'propulsion-indicator empty';
                propulsion2.className = propulsionesDisponibles >= 2 ? 'propulsion-indicator' : 'propulsion-indicator empty';
                propulsion3.className = propulsionesDisponibles >= 3 ? 'propulsion-indicator' : 'propulsion-indicator empty';
            }
            
            // Función para crear un nuevo asteroide
            function crearAsteroide() {
                const ancho = Math.random() * 30 + 20; // Ancho entre 20 y 50
                const tipo = Math.floor(Math.random() * 4); // 0: arriba, 1: derecha, 2: izquierda, 3: abajo
                let x, y, velocidadX = 0, velocidadY = 0;
                
                switch(tipo) {
                    case 0: // Desde arriba
                        x = Math.random() * (canvas.width - ancho);
                        y = -ancho;
                        velocidadY = Math.random() * 2 + 1 + nivel * 0.5;
                        break;
                    case 1: // Desde la derecha
                        x = canvas.width + ancho;
                        y = Math.random() * (canvas.height - ancho);
                        velocidadX = -(Math.random() * 2 + 1 + nivel * 0.5);
                        break;
                    case 2: // Desde la izquierda
                        x = -ancho;
                        y = Math.random() * (canvas.height - ancho);
                        velocidadX = Math.random() * 2 + 1 + nivel * 0.5;
                        break;
                    case 3: // Desde abajo (menos frecuente)
                        if (Math.random() < 0.3) { // Solo 30% de probabilidad
                            x = Math.random() * (canvas.width - ancho);
                            y = canvas.height + ancho;
                            velocidadY = -(Math.random() * 2 + 1 + nivel * 0.5);
                        } else {
                            // Si no se crea desde abajo, crear desde arriba
                            x = Math.random() * (canvas.width - ancho);
                            y = -ancho;
                            velocidadY = Math.random() * 2 + 1 + nivel * 0.5;
                        }
                        break;
                }
                
                const asteroide = {
                    x: x,
                    y: y,
                    ancho: ancho,
                    alto: ancho,
                    velocidadX: velocidadX,
                    velocidadY: velocidadY
                };
                
                asteroides.push(asteroide);
            }
            
            // Función para actualizar la posición de la nave
            function actualizarNave(deltaTime) {
                // Aplicar propulsión si está activa
                if (nave.propulsion) {
                    nave.velocidad = nave.velocidadBase * 2; // Doble velocidad con propulsión
                } else {
                    nave.velocidad = nave.velocidadBase;
                }
                
                // Calcular velocidad en X e Y
                if (nave.frenando) {
                    // Si está frenando, reducir velocidad rápidamente
                    nave.velocidadX *= 0.8;
                    nave.velocidadY *= 0.8;
                } else {
                    // Aplicar movimiento según teclas presionadas
                    if (nave.movIzquierda) {
                        nave.velocidadX = -nave.velocidad;
                    } else if (nave.movDerecha) {
                        nave.velocidadX = nave.velocidad;
                    } else {
                        // Desaceleración natural en X
                        nave.velocidadX *= 0.95;
                    }
                    
                    if (nave.movArriba) {
                        nave.velocidadY = -nave.velocidad;
                    } else if (nave.movAbajo) {
                        nave.velocidadY = nave.velocidad;
                    } else {
                        // Desaceleración natural en Y
                        nave.velocidadY *= 0.95;
                    }
                }
                
                // Actualizar posición
                nave.x += nave.velocidadX;
                nave.y += nave.velocidadY;
                
                // Limitar a los bordes del canvas
                if (nave.x < 0) nave.x = 0;
                if (nave.x > canvas.width - nave.ancho) nave.x = canvas.width - nave.ancho;
                if (nave.y < 0) nave.y = 0;
                if (nave.y > canvas.height - nave.alto) nave.y = canvas.height - nave.alto;
                
                // Recargar propulsiones
                if (propulsionesDisponibles < 3) {
                    const tiempoActual = Date.now();
                    if (tiempoActual - tiempoUltimaPropulsion > tiempoRecargaPropulsion) {
                        propulsionesDisponibles++;
                        tiempoUltimaPropulsion = tiempoActual;
                        actualizarIndicadoresPropulsion();
                    }
                }
            }
            
            // Función para actualizar los asteroides
            function actualizarAsteroides() {
                for (let i = 0; i < asteroides.length; i++) {
                    asteroides[i].x += asteroides[i].velocidadX;
                    asteroides[i].y += asteroides[i].velocidadY;
                    
                    // Eliminar asteroides que salen de la pantalla
                    if (
                        asteroides[i].x < -asteroides[i].ancho * 2 ||
                        asteroides[i].x > canvas.width + asteroides[i].ancho * 2 ||
                        asteroides[i].y < -asteroides[i].alto * 2 ||
                        asteroides[i].y > canvas.height + asteroides[i].alto * 2
                    ) {
                        asteroides.splice(i, 1);
                        i--;
                        puntuacion += 10; // Puntos por esquivar
                        puntuacionActual.textContent = puntuacion;
                    }
                }
                
                // Crear nuevos asteroides según el nivel
                if (Math.random() < 0.02 + nivel * 0.01) {
                    crearAsteroide();
                }
            }
            
            // Función para detectar colisiones
            function detectarColisiones() {
                for (let i = 0; i < asteroides.length; i++) {
                    const a = asteroides[i];
                    
                    // Colisión simple con rectángulos
                    if (
                        nave.x < a.x + a.ancho &&
                        nave.x + nave.ancho > a.x &&
                        nave.y < a.y + a.alto &&
                        nave.y + nave.alto > a.y
                    ) {
                        gameOver();
                        return;
                    }
                }
            }
            
            // Función para dibujar todo
            function dibujar() {
                // Limpiar canvas
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Dibujar nave
                try {
                    ctx.drawImage(naveImg, nave.x, nave.y, nave.ancho, nave.alto);
                    
                    // Dibujar efecto de propulsión si está activa
                    if (nave.propulsion) {
                        ctx.fillStyle = '#ff6b00';
                        ctx.beginPath();
                        if (nave.movIzquierda) {
                            // Propulsión hacia la derecha
                            ctx.moveTo(nave.x + nave.ancho, nave.y + nave.alto / 2);
                            ctx.lineTo(nave.x + nave.ancho + 20, nave.y + nave.alto / 2 - 10);
                            ctx.lineTo(nave.x + nave.ancho + 20, nave.y + nave.alto / 2 + 10);
                        } else if (nave.movDerecha) {
                            // Propulsión hacia la izquierda
                            ctx.moveTo(nave.x, nave.y + nave.alto / 2);
                            ctx.lineTo(nave.x - 20, nave.y + nave.alto / 2 - 10);
                            ctx.lineTo(nave.x - 20, nave.y + nave.alto / 2 + 10);
                        } else if (nave.movArriba) {
                            // Propulsión hacia abajo
                            ctx.moveTo(nave.x + nave.ancho / 2, nave.y + nave.alto);
                            ctx.lineTo(nave.x + nave.ancho / 2 - 10, nave.y + nave.alto + 20);
                            ctx.lineTo(nave.x + nave.ancho / 2 + 10, nave.y + nave.alto + 20);
                        } else if (nave.movAbajo) {
                            // Propulsión hacia arriba
                            ctx.moveTo(nave.x + nave.ancho / 2, nave.y);
                            ctx.lineTo(nave.x + nave.ancho / 2 - 10, nave.y - 20);
                            ctx.lineTo(nave.x + nave.ancho / 2 + 10, nave.y - 20);
                        }
                        ctx.fill();
                    }
                    
                    // Dibujar efecto de frenado si está activo
                    if (nave.frenando) {
                        ctx.fillStyle = 'rgba(255, 0, 0, 0.5)';
                        ctx.beginPath();
                        ctx.arc(nave.x + nave.ancho / 2, nave.y + nave.alto / 2, nave.ancho, 0, Math.PI * 2);
                        ctx.fill();
                    }
                } catch (e) {
                    // Si la imagen no está disponible, dibujar un rectángulo
                    ctx.fillStyle = '#4a6bdb';
                    ctx.fillRect(nave.x, nave.y, nave.ancho, nave.alto);
                }
                
                // Dibujar asteroides
                // Dibujar asteroides
for (let i = 0; i < asteroides.length; i++) {
    try {
        ctx.drawImage(asteroideImg, asteroides[i].x, asteroides[i].y, asteroides[i].ancho, asteroides[i].alto);
    } catch (e) {
        // Si la imagen no está disponible, dibujar un círculo
        ctx.fillStyle = '#ff4500';
        ctx.beginPath();
        ctx.arc(
            asteroides[i].x + asteroides[i].ancho / 2,
            asteroides[i].y + asteroides[i].alto / 2,
            asteroides[i].ancho / 2,
            0,
            Math.PI * 2
        );
        ctx.fill();
    }
}

            
        
    }
            // Función principal del juego
            function gameLoop(tiempoActual) {
                if (!juegoActivo) return;
                
                // Calcular delta time para movimientos suaves
                const deltaTime = tiempoActual - ultimoTiempo;
                ultimoTiempo = tiempoActual;
                
                actualizarNave(deltaTime);
                actualizarAsteroides();
                detectarColisiones();
                dibujar();
                
                // Aumentar nivel cada 1000 puntos
                const nuevoNivel = Math.floor(puntuacion / 1000) + 1;
                if (nuevoNivel > nivel) {
                    nivel = nuevoNivel;
                    nivelActual.textContent = nivel;
                }
                
                requestAnimationFrame(gameLoop);
            }
            
            // Función para iniciar el juego
            function iniciarJuego() {
                juegoActivo = true;
                puntuacion = 0;
                nivel = 1;
                asteroides = [];
                propulsionesDisponibles = 3;
                
                nave.x = canvas.width / 2 - 25;
                nave.y = canvas.height - 100;
                nave.velocidadX = 0;
                nave.velocidadY = 0;
                
                puntuacionActual.textContent = puntuacion;
                nivelActual.textContent = nivel;
                
                actualizarIndicadoresPropulsion();
                
                pantallaInicio.style.display = 'none';
                pantallaGameover.style.display = 'none';
                marcador.style.display = 'block';
                propulsionContainer.style.display = 'flex';
                controlInfo.style.display = 'block';
                
                ultimoTiempo = performance.now();
                requestAnimationFrame(gameLoop);
            }
            
            // Función para game over
            function gameOver() {
                juegoActivo = false;
                
                puntuacionFinal.textContent = puntuacion;
                
                // Actualizar récord si es necesario
                if (puntuacion > record) {
                    record = puntuacion;
                    localStorage.setItem('piltrip_record', record);
                    recordElement.textContent = record;
                }
                
                pantallaGameover.style.display = 'flex';
                propulsionContainer.style.display = 'none';
                controlInfo.style.display = 'none';
            }
            
            // Función para activar pantalla completa
            function toggleFullScreen() {
                if (!document.fullscreenElement) {
                    gameContainer.requestFullscreen().catch(err => {
                        console.error(`Error al intentar pantalla completa: ${err.message}`);
                    });
                } else {
                    document.exitFullscreen();
                }
            }
            
            // Event listeners para los botones
            btnIniciar.addEventListener('click', iniciarJuego);
            btnReiniciar.addEventListener('click', iniciarJuego);
            btnFullscreen.addEventListener('click', toggleFullScreen);
            btnFullscreenGameover.addEventListener('click', toggleFullScreen);
            
            // Ajustar tamaño del canvas cuando cambia el tamaño de la ventana
            function ajustarCanvas() {
                const contenedor = canvas.parentElement;
                const ratio = canvas.width / canvas.height;
                
                const nuevoAncho = contenedor.clientWidth;
                const nuevoAlto = nuevoAncho / ratio;
                
                canvas.style.width = nuevoAncho + 'px';
                canvas.style.height = nuevoAlto + 'px';
            }
            
            window.addEventListener('resize', ajustarCanvas);
            ajustarCanvas(); // Ajustar al cargar
        });
    </script>
</body>
</html>